"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var __awaiter=function(a,r,s,l){return new(s||(s=Promise))(function(t,e){function o(t){try{i(l.next(t))}catch(t){e(t)}}function n(t){try{i(l.throw(t))}catch(t){e(t)}}function i(e){e.done?t(e.value):new s(function(t){t(e.value)}).then(o,n)}i((l=l.apply(a,r||[])).next())})},__generator=function(o,n){var i,a,r,t,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,a&&(r=2&e[0]?a.return:e[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,e[1])).done)return r;switch(a=0,r&&(e=[2&e[0],r.value]),e[0]){case 0:case 1:r=e;break;case 4:return s.label++,{value:e[1],done:!1};case 5:s.label++,a=e[1],e=[0];continue;case 7:e=s.ops.pop(),s.trys.pop();continue;default:if(!(r=0<(r=s.trys).length&&r[r.length-1])&&(6===e[0]||2===e[0])){s=0;continue}if(3===e[0]&&(!r||e[1]>r[0]&&e[1]<r[3])){s.label=e[1];break}if(6===e[0]&&s.label<r[1]){s.label=r[1],r=e;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(e);break}r[2]&&s.ops.pop(),s.trys.pop();continue}e=n.call(o,s)}catch(t){e=[6,t],a=0}finally{i=r=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},Item=function(){function t(t){this.id=t.id,this.title=t.title,this.element=t.element,this.type=t.type,this.categories=t.categories;var e=this.removeSpecialChars(t.price);isNaN(e)?t.price=0:this.price=this.removeSpecialChars(e),this.image=t.image.path,this.desc=t.desc,this.onCart=!!t.onCart}return t.prototype.outputOverlay=function(t){void 0===t&&(t=null);var e=this.onCart?"Remove From Cart":"Add To Cart",o=this.onCart?"onCart":"",n='\n            <div id="overlayPad">\n                <div class="overlayImg">\n                    <img src="https://feinberg-dev.fsm.northwestern.edu/it-new/'+this.image+'" />\n                </div>\n                <div class="overlayText">\n                    <h3>'+this.title+"</h3>";return"0.00"!=this.price&&(n+="<h6>$"+this.numberWithCommas(this.price)+"</h6>"),n+="<div>"+this.desc+"</div><br />","0.00"!=this.price&&(n+='<a id="atcModalBtn" class="button '+o+'" href="#" data-num="'+t+'" >'+e+"</a>"),n+="</div>\n            </div>"},t.prototype.numberWithCommas=function(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},t.prototype.removeSpecialChars=function(t){return t.replace(/[`~!@#$%^&*()_|+\-=?;:'",<>\{\}\[\]\\\/]/gi,"")},t}(),Cart=function(){function t(t,e){this.basket=[],this.mappedBasket=[],this.cartCount=0,this.cartTotal=0,this.cartBtnTxt={Add:"Add To Cart",Remove:"Remove From Cart",Info:"More Info"},this.modal=t,this.cookie=e,this.makeCartInBrowser()}return t.prototype.mapCart=function(){if(this.mappedBasket=this.basket.map(function(t){return t.id}),0<this.mappedBasket.length){var t=JSON.stringify(this.mappedBasket);this.cookie.setCookie(t,1)}else this.cookie.deleteCookie()},t.prototype.addOrRemoveFromCart=function(o){var n;if(0<this.basket.length){if(this.basket.forEach(function(t,e){t.id===o.id&&(n=e)}),console.log(n),-1===n||void 0===n){var t=this.addToBasket(o);return this.updateCartTotalAndCount(),t}for(var e=this.removeFromBasket(n)[0],i=document.getElementsByClassName("atcBtn"),a=0;a<i.length;a++){var r=i[a].getAttribute("data-id");e.id==r&&this.toggleATCbutton(i[a],!1)}return this.updateCartTotalAndCount(),!1}if(null!=o.id||null!=o.id){t=this.addToBasket(o);return this.updateCartTotalAndCount(),t}},t.prototype.addToBasket=function(t){return this.basket.push(t),console.log("Basket: ",this.basket),!0},t.prototype.removeFromBasket=function(t){return console.log("Removing this: ",t),this.basket.splice(t,1)},t.prototype.inBasket=function(o){this.basket.forEach(function(t,e){return t.id===o&&e})},t.prototype.totalCart=function(){var e=this;if(0<this.basket.length){var o=0;return this.basket.forEach(function(t){o+=parseFloat(e.removeSpecialChars(t.price))}),o}},t.prototype.countCart=function(){return console.log("Cart count: ",this.cartCount),this.basket.length},t.prototype.updateCartTotalAndCount=function(){if(this.mapCart(),this.cartTotal=this.totalCart(),this.cartCount=this.countCart(),0<this.cartCount){document.getElementById("cart").style.height="75px";var t="";console.log("Cart Count: ",this.cartCount),2<=this.cartCount?t+="<p>"+this.cartCount+" items<br />":t+="<p>"+this.cartCount+" item<br />",t+="Total: $"+this.numberWithCommas(this.cartTotal)+"</p>",document.getElementById("cartLeft").innerHTML=t}else document.getElementById("cart").style.height="0";console.log(this.cookie.getJSONfromCookieAsArray())},t.prototype.makeCartInBrowser=function(){var o=this;document.body.insertAdjacentHTML("beforeend",'<div id="cart">\n                    <div>\n                        <div id="cartLeft"></div>\n                        <div id="cartRight">\n                            <a id="viewCart" class="button">View Cart</a>\n                        </div>\n                    </div>\n                </div>'),document.getElementById("viewCart").addEventListener("click",function(t){var e=o.listCart();0<o.cartTotal?(o.modal.openOverlay(e),o.wireUpCartDeletes(),t.preventDefault()):o.modal.closeOverlay(document.getElementById(o.modal.overlayContainerGuts),document.getElementById(o.modal.overlayContainerID),window.scrollY)})},t.prototype.wireUpCartDeletes=function(){var n=this;if(0<this.countCart()){var t=document.getElementsByClassName("crDeleteBtn"),e=document.getElementsByClassName("crDeleteEmbed");if(0<t.length)for(var o=function(o){o.addEventListener("click",function(t){var e=o.getAttribute("data-basket-position");n.addOrRemoveFromCart(n.basket[e]),n.modal.updateOverlayContent(n.listCart()),n.wireUpCartDeletes(),t.preventDefault()})},i=0,a=t;i<a.length;i++){o(a[i])}if(0<e.length)for(var r=function(o){o.addEventListener("click",function(t){var e=o.getAttribute("data-basket-position");n.addOrRemoveFromCart(n.basket[e]),n.modal.updateOverlayContent(n.listCart()),n.wireUpCartDeletes(),t.preventDefault()})},s=0,l=e;s<l.length;s++){r(l[s])}}else this.modal.closeOverlay(document.getElementById(this.modal.overlayContainerGuts),document.getElementById(this.modal.overlayContainerID),window.scrollY)},t.prototype.listCart=function(){var o=this;if(this.cartCount=this.countCart(),0<this.cartCount){var n='<div id="cartList">';return this.basket.forEach(function(t,e){n+='<div class="cartRow">\n                    <div class="crImg">\n                        <img src="https://feinberg-dev.fsm.northwestern.edu/it-new/'+t.image+'" alt="'+t.title+'-image" />\n                    </div>\n                    <div class="crDesc">\n                        <p>'+t.title+'</p>\n                        <a class="crDeleteEmbed" data-basket-position="'+e+'" >Delete</a>\n                    </div>\n                    <div class="crDelete"> \n                        <p><a class="crDeleteBtn" data-basket-position="'+e+'" href="">Delete</a></p>\n                    </div>\n                    <div><p>$'+o.numberWithCommas(t.price,!1)+"</p></div>\n                </div>"}),n+='\n                <div class="cartRow">\n                    <div class="crImg">&nbsp;</div>\n                    <div class="crDesc">&nbsp;</div>\n                    <div class="crDelete">Total:</div>\n                    <div>$'+this.numberWithCommas(this.totalCart(),!0)+'</div>\n                </div>\n                <div class="cartRow">\n                    <div class="checkoutRow">\n                        <a href="#" class="button">Checkout Now</a> \n                    </div>\n                </div>\n            ',n+="</div>"}},t.prototype.toggleATCbutton=function(t,e){e?(t.classList.add("onCart"),t.textContent=this.cartBtnTxt.Remove):(t.classList.remove("onCart"),t.textContent=this.cartBtnTxt.Add),t.blur()},t.prototype.numberWithCommas=function(t,e){return void 0===e&&(e=!0),e?t.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},t.prototype.removeSpecialChars=function(t){return t.replace(/[`~!@#$%^&*()_|+\-=?;:'",<>\{\}\[\]\\\/]/gi,"")},t}(),Store=function(){function t(t,e,o,n){this.apiURL="https://feinberg-dev.fsm.northwestern.edu/it-new/ws/purchasing-api.php",this.items=[{}],this.modal=o,this.cookie=n,this.cart=e,this.containerEL=document.getElementById(t),this.stockTheShelves()}return t.prototype.loadProducts=function(){var o=this,n=this.cookie.getJSONfromCookieAsArray();return fetch(this.apiURL).then(function(t){return t.json()}).then(function(t){return 0<t.items.length&&(t.items.forEach(function(t,e){0<n.length&&(n.includes(t.id)?(t.onCart=!0,o.cart.addOrRemoveFromCart(t)):t.onCart=!1),o.items[e]=new Item(t)}),!0)})},t.prototype.stockTheShelves=function(){return __awaiter(this,void 0,void 0,function(){var a,e,o,n,i,r,s,l,c,d,u,p=this;return __generator(this,function(t){switch(t.label){case 0:return[4,this.loadProducts()];case 1:if(t.sent()){for(a='<div class="bootstrap-wrapper">\n                            <div class="container-fluid">\n                                <section id="filterChecks">\n                                    <form class="row">\n                                        <div class="col-6">\n                                                <label>Filter by Category:</label>\n                                                <select id="filterCat" class="filterOptions">\n                                                    <option value="all">Show All</option>\n                                                    <option value="bundles">Bundles</option>\n                                                    <option value="desktops">Desktops</option>\n                                                    <option value="laptops">Laptops</option>\n                                                    <option value="monitors">Monitors</option>\n                                                    <option value="apple desktops">Apple Desktops</option>\n                                                    <option value="apple laptops">Apple Laptops</option>\n                                                    <option value="ipads">iPads</option>\n                                                    <option value="tablets">Tablets</option>\n                                                    <option value="printers">Printers</option>\n                                                    <option value="software">software</option>\n                                                </select>\n                                        </div>\n                                        <div class="col-6">\n                                            <label>Filter by OS:</label>\n                                            <select id="filterOS" class="filterOptions">\n                                                <option value="all">Show All</option>\n                                                <option value="apple">Apple</option>\n                                                <option value="pc">PC</option>\n                                            </select>\n                                        </div>   \n                                    </form>\n                                </section>\n                                <section class="shelves"><div class="row">',this.items.forEach(function(t,e){var o="";"object"==_typeof(t.categories.value)?t.categories.value.forEach(function(t){t&&(o=o+""+t+" ")}):o=t.categories.value;var n=0==t.price?"":"$"+p.numberWithCommas(t.price),i=0==t.price?"More Info":"Add To Cart";a+='<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 pbc" data-os="'+t.type+'" data-catString="'+o+'"><article class="feature-box prodBox" data-id="'+t.id+'" data-num="'+e+'" >   \n                                    <div class="img-container">\n                                        <img class="img-fluid" src="https://feinberg-dev.fsm.northwestern.edu/it-new/'+t.image+'" alt="'+t.title+'-image" />\n                                    </div>\n                                    <div class="feature-copy">\n                                        <h6>'+t.title+"</h6>\n                                        <p>"+n+'</p>\n                                        <a class="specs" data-id="'+t.id+'">Read product specs</a>\n                                    </div>',a+='<a class="button atcBtn',t.onCart&&(a+=" onCart ",i=p.cart.cartBtnTxt.Remove),a+=' " data-num="'+e+'" data-id="'+t.id+'" data-isCartBtn="true" href="#">'+i+"</a></article></div>"}),a+="</div></section>\n                            </div></div>",this.containerEL.insertAdjacentHTML("beforeend",a),e=function(i){i.addEventListener("click",function(t){t.preventDefault();var e=i.getAttribute("data-num"),o=p.items[e].outputOverlay(e);p.modal.openOverlay(o);var n=document.getElementById("atcModalBtn");n.addEventListener("click",function(t){p.addToCartToggle(e,n)})})},o=0,n=document.getElementsByClassName("prodBox");o<n.length;o++)i=n[o],e(i);for(r=function(n){n.addEventListener("click",function(t){var e=n.getAttribute("data-num");if("0.00"!=p.items[e].price)p.addToCartToggle(e,n),t.preventDefault(),t.stopPropagation();else{var o=p.items[e].outputOverlay(e);p.modal.openOverlay(o),t.preventDefault(),t.stopPropagation()}})},s=0,l=document.getElementsByClassName("atcBtn");s<l.length;s++)c=l[s],r(c);d=document.getElementById("filterCat"),u=document.getElementById("filterOS"),d.addEventListener("change",function(t){p.filterShelves(d,u)}),u.addEventListener("change",function(t){p.filterShelves(d,u)})}return[2]}})})},t.prototype.addToCartToggle=function(t,e){this.cart.addOrRemoveFromCart(this.items[t])?(this.items[t].onCart=!0,this.cart.toggleATCbutton(e,!0)):(this.items[t].onCart=!1,this.cart.toggleATCbutton(e,!1))},t.prototype.filterShelves=function(t,e){var o=document.getElementsByClassName("pbc"),n=t.options[t.selectedIndex].value,i=e.options[e.selectedIndex].value;console.log("Selected OS: ",i),this.showAllProducts(o),"all"!=n?this.hideShowProducts(o,n,i):"all"!=i?this.hideShowProducts(o,n,i):this.showAllProducts(o)},t.prototype.hideShowProducts=function(t,e,o){for(var n=0;n<t.length;n++){var i=t[n],a=i.getAttribute("data-catString"),r=i.getAttribute("data-os");"all"==e||a.includes(e)||(i.style.display="none"),"all"==o||r.includes(o)||(i.style.display="none")}},t.prototype.showAllProducts=function(t){for(var e=0;e<t.length;e++){t[e].style.display="flex"}},t.prototype.numberWithCommas=function(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},t.prototype.removeSpecialChars=function(t){return t.replace(/[`~!@#$%^&*()_|+\-=?;:'",<>\{\}\[\]\\\/]/gi,"")},t}(),Modal=function(){function t(){this.overlayContainerID="overlay",this.overlayContainerGuts="overlayGuts",this.addOverlay()}return t.prototype.addOverlay=function(){document.getElementById("main-content").insertAdjacentHTML("beforeend",'<div id="overlay"><div id="overlay-content"><a class="closebtn"><i class="fa fa-times"> </i></a><div id="overlayGuts" class="col1of1 responsive-container"></div></div></div>')},t.prototype.updateOverlayContent=function(t){document.getElementById(this.overlayContainerGuts).innerHTML=t},t.prototype.openOverlay=function(t){var e=this,o=window.scrollY;window.scroll(0,o);var n=document.getElementById(this.overlayContainerID),i=document.getElementById(this.overlayContainerGuts);this.updateOverlayContent(t),n.style.height="100%",n.style.display="block",document.body.classList.add("modal-open"),n.getElementsByClassName("closebtn")[0].addEventListener("click",function(t){e.closeOverlay(i,n,o),t.preventDefault()}),document.addEventListener("keydown",function(t){"Escape"===t.key&&(e.closeOverlay(i,n,o),t.preventDefault())})},t.prototype.closeOverlay=function(t,e,o){t.innerHTML="",e.style.height="0%",e.style.display="none",document.body.classList.remove("modal-open"),window.scroll(0,o)},t}(),Cookie=function(){function t(t){this.name=t}return t.prototype.setCookie=function(t,e){var o=new Date;o.setTime(o.getTime()+864e5*e),document.cookie=this.name+"="+t+";path=/;expires="+o.toUTCString()},t.prototype.getCookie=function(){var t=document.cookie.match("(^|;) ?"+this.name+"=([^;]*)(;|$)");return t?t[2]:null},t.prototype.getJSONfromCookieAsArray=function(){var t=JSON.parse(this.getCookie());return t||[]},t.prototype.deleteCookie=function(){this.setCookie("",-1)},t}();window.onload=function(){var t=new Cookie("fsmITPurchasing"),e=new Modal,o=new Cart(e,t);new Store("shopping-cart",o,e,t)};